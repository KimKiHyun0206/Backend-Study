# Spring ì˜ ë™ì‘ ê³¼ì •

> Spring MVC êµ¬ì¡°ì˜ ì²˜ë¦¬ ê³¼ì •

![img.png](../ğŸ”²%20Image%20ğŸ”²/Spring/Springì˜%20ë™ì‘%20ê³¼ì •.png)

> ### ìƒ‰ìƒ ì˜ë¯¸
> `ë³´ë¼ìƒ‰` : ê°œë°œìê°€ êµ¬í˜„í•˜ëŠ” ë¶€ë¶„
>
> `íŒŒë€ìƒ‰` : Spring ì—ì„œ ìë™ì ìœ¼ë¡œ ì œê³µí•˜ëŠ” ë¶€ë¶„
>
> `ì´ˆë¡ìƒ‰` : Spring ì—ì„œ ìë™ìœ¼ë¡œ ì œê³µí•˜ì§€ë§Œ, ê°€ë” ê°œë°œìê°€ êµ¬í˜„í•˜ëŠ” ë¶€ë¶„

# ê° ëª¨ë“ˆì˜ ì—­í• 

## 1. DispatcherServlet

* ì• í”Œë¦¬ì¼€ì´ì…˜ìœ¼ë¡œ ë“¤ì–´ì˜¤ëŠ” ëª¨ë“  Request ë¥¼ ë°›ëŠ” ë¶€ë¶„
* Request ë¥¼ ì‹¤ì œë¡œ ì²˜ë¦¬í•  Controller ì—ì„œ ì „ë‹¬í•œë‹¤
* ì „ë‹¬ í›„ ê²°ê³¼ê°’ì„ ë°›ì•„ì„œ View ì— ì „ë‹¬í•˜ì—¬ ì ì ˆí•œ ì‘ë‹µì„ ìƒì„±í•  ìˆ˜ ìˆë„ë¡ íë¦„ ì œì–´

## 2. HandlerMapping

* Request URL ì— ë”°ë¼ ê°ê° ì–´ë–¤ Controller ê°€ ì‹¤ì œë¡œ ì²˜ë¦¬í•  ê²ƒì¸ì§€ ì°¾ì•„ì¤€ë‹¤
* ì•„ë˜ ì½”ë“œì˜ ê²½ìš° Controller ë§ˆë‹¤ ê°€ì§„ URL ì´ ë‹¤ë¥´ë‹¤

```java

@RestController
@RequestMapping(value = "/api/v1", produces = MediaType.APPLICATION_JSON_VALUE)
public class OneController {
    ...
}

@RestController
@RequestMapping(value = "/api/v2", produces = MediaType.APPLICATION_JSON_VALUE)
public class TwoController {
    ...
}
```

## 3. Controller

* Request ë¥¼ ì§ì ‘ ì²˜ë¦¬í•œ í›„ ê·¸ ê²°ê³¼ë¥¼ ë‹¤ì‹œ DispatcherServlet ì—ê²Œ ì „ë‹¬í•œë‹¤
* ì•„ë˜ ì½”ë“œë¥¼ ë³´ë©´ DispatcherServlet ì—ê²Œ `return` í•œë‹¤

```java

@Api(tags = {"Diary API"})
@RestController
@RequestMapping(value = "/api/v1/diaries", produces = MediaType.APPLICATION_JSON_VALUE)
@RequiredArgsConstructor
public class DiaryController {
    private final DiaryService diaryService;
    private final FeelingService feelingService;

    @ApiOperation(value = "Diary ë“±ë¡í•˜ê¸°")
    @PostMapping(consumes = MediaType.APPLICATION_JSON_VALUE, value = "/register")
    public ResponseEntity<?> register(@RequestBody DiaryRegisterRequest request) {
        var response = diaryService.register(request);
        return ResponseDto.created(response);
    }

    @ApiOperation(value = "Diary ë‹¨ê±´ ì¡°íšŒí•˜ê¸°")
    @GetMapping("/{id}")
    public ResponseEntity<?> get(@PathVariable Long id) {
        var response = diaryService.get(id);
        return ResponseDto.ok(response);
    }

    @ApiOperation(value = "Diary ì „ì²´ ì¡°íšŒí•˜ê¸°")
    @GetMapping("/search-all")
    public ResponseEntity<?> getAll(
            @PageableDefault(sort = "createdAt", direction = Sort.Direction.DESC) Pageable pageable
    ) {
        var response = diaryService.getAll(pageable);
        return PageDto.ok(response);
    }

    @ApiOperation(value = "Diary ìˆ˜ì •í•˜ê¸°")
    @PutMapping("/{id}") // @PatchMapping
    public ResponseEntity<?> update(
            @PathVariable Long id,
            @RequestBody DiaryUpdateRequest request
    ) {
        var response = diaryService.update(id, request);
        return ResponseDto.ok(response);
    }

    @ApiOperation(value = "Diary ì‚­ì œí•˜ê¸°")
    @DeleteMapping("/{id}")
    public ResponseEntity<Void> delete(
            @PathVariable Long id
    ) {
        diaryService.delete(id);
        return ResponseDto.noContent();
    }

    @ApiOperation(value = "Diary ì›”ë³„ ì‚­ì œí•˜ê¸°")
    @DeleteMapping("/month/{month}")
    public ResponseEntity<Void> monthDelete(@PathVariable int month) {
        diaryService.monthDelete(month);
        return ResponseDto.noContent();
    }

    @ApiOperation(value = "Feeling ìˆ˜ì •í•˜ê¸°")
    @PutMapping(consumes = MediaType.APPLICATION_JSON_VALUE, value = "/feeling/{id}")
    public ResponseEntity<?> updateFeeling(@PathVariable Long id, @RequestBody FeelingUpdateRequest request) {
        var response = feelingService.updateFeeling(id, request);
        return ResponseDto.ok(response);
    }

    @ApiOperation(value = "Feeling ì „ì²´ ì¡°íšŒí•˜ê¸°")
    @GetMapping("/feeling-all")
    public ResponseEntity<?> getAllFeeling(@PageableDefault Pageable pageable) {
        var response = feelingService.getAllFeeling(pageable);
        return PageDto.ok(response);
    }
}
```

## 4. ModelAndView

* Controller ê°€ ì²˜ë¦¬í•œ ê²°ê³¼ì™€ ê·¸ ê²°ê³¼ë¥¼ ë³´ì—¬ì¤„ View ì— ê´€í•œ ì •ë³´ë¥¼ ë‹´ê³  ìˆëŠ” ê°ì²´

<details>
<summary>ModelAndView ì½”ë“œ ì„¤ëª…</summary>
<div markdown="1">
<br>

```java

@Controller
public class Controller {
    @RequestMapping("/sample")
    public ModelAndView modelAndViewSample() {
        ModelAndView modelAndView = new ModelAndView();
        modelAndView.addObject("serverTime", new Date());
        modelAndView.setViewName("/response/model-and-view");

        return modelAndView;
    }

    @RequestMapping("/sample/model-and-view/model-attribute")
    public String modelAttributeSample(@ModelAttribute("id") String id) {
        System.out.println(id);
        return "response/model-and-view/model-attribute";
    }

    @RequestMapping("/sample/model-and-view/model-attribute/vo")
    public String modelAttributeSample(@ModelAttribute("id") RequestVo request) {
        System.out.println(request.toString());
        return "response/model-and-view/model-attribute/vo";
    }
}
```

```html
<!--- View ì—ì„œëŠ” ë˜‘ê°™ì´ EL í‘œê¸°ë²•ì„ ì‚¬ìš©í•´ì„œ êº¼ë‚¸ë‹¤ --->
<h3>ModelAndView ë¡œ ë„˜ì–´ì˜¨ ê°’</h3>
${serverTime}
```

```html
<h3>ModelAttribute ë°©ë²•</h3>
${id}
```

```html
<!--- View ì—ì„œëŠ” í‚¤ ê°’ì¸ info ì— . ì„ ì°ì–´ì„œ EL í‘œê¸°ë²•ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤ --->
<h3>ModelAttribute + VO ë°©ë²•</h3>
${info.id}
<br>
${info.name}
```

### Model ê°ì²´

```java

@Controller
public class Controller {
    @RequestMapping("/sample")
    public String modelSample(Model model) {
        model.addAttribute("itemName", model.getItemName());
        model.addAttribute("price", model.getPrice());

        return "response/modelSample";
    }
}
```

```html
<h3>Model ë¡œ ë„˜ì–´ì˜¨ ê°’</h3>
${itemName}
<br>
${price}
```

</div>
</details>

## 5. ViewResolver

* View ê´€ë ¨ ì •ë³´ë¥¼ ê°–ê³  ì‹¤ì œ View ë¥¼ ì°¾ì•„ì£¼ëŠ” ì—­í• 

### ë™ì‘ ë°©ì‹

> ë‘ ê°€ì§€ ë°©ë²•

1. ë¹ˆ ì´ë¦„ìœ¼ë¡œ ë·°ë¥¼ ì°¾ì•„ì„œ ë°˜í™˜í•œë‹¤
2. JSP ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ë·°ë¥¼ ë°˜í™˜í•œë‹¤

## 6. View

* Controller ê°€ ì²˜ë¦¬í•œ ê²°ê³¼ê°’ì„ ë³´ì—¬ì¤„ View ìƒì„±
* ì‹¤ì œ HTML ì½”ë“œë‚˜ Servlet ìœ¼ë¡œ ë§Œë“  ë™ì  í˜ì´ì§€ë¥¼ ë§í•œë‹¤

```html
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<html>
<head>
    <meta charset="UTF-8">
    <title>ì œëª©</title>
</head>
<body>
<form action="save" method="post">
    username: <input type="text" name="username"/>
    age: <input type="text" name="age"/>
    <button type="submit">ì „ì†¡</button>
</form>
</body>
</html>
```

<br>

---
### ë§í¬
* [ğŸ”— Spring ì˜ ë™ì‘ ê³¼ì •](https://jaeho214.tistory.com/22)
* [ğŸ”— ViewResolver ë€ ë¬´ì—‡ì¸ê°€](https://ittrue.tistory.com/237)
* [ğŸ”— ModelAndView](https://rsorry.tistory.com/261)